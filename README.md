# 手写数字识别系统

这是一个基于深度学习的手写数字识别系统，可以识别0-9的手写数字。该系统使用PyTorch框架实现，支持两种经典的神经网络模型（LeNet-5和MLP），并提供了命令行和图形界面两种使用方式。

## 项目功能

- 支持两种深度学习模型：LeNet-5和多层感知器(MLP)
- 自动下载和处理MNIST数据集
- 提供完整的模型训练、评估和保存功能
- 支持图像预处理，包括二值化、尺寸调整、数字居中等
- 提供命令行和图形界面两种使用方式
- 支持手绘数字识别和图像文件识别
- 显示识别结果和置信度

## 目录结构

```
numbers_recognizer/
├── data/             # 存储MNIST数据集
├── models/           # 存储训练好的模型和模型定义
│   └── model_definition.py  # 模型定义文件
├── utils/            # 工具函数
│   ├── data_loader.py       # 数据加载和预处理
│   └── image_preprocessing.py  # 图像预处理工具
├── train.py          # 模型训练脚本
├── infer.py          # 推理和识别脚本
├── gui_app.py        # 图形界面应用
├── requirements.txt  # 项目依赖
└── README.md         # 项目说明文档
```

## 安装指南

1. 确保已安装Python 3.7或更高版本

2. 克隆或下载项目代码到本地

3. 安装项目依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 1. 训练模型

首先需要训练模型，可以选择训练LeNet-5模型或MLP模型：

```bash
python train.py
```

训练脚本会自动下载MNIST数据集，训练完成后会保存最佳模型到`models/`目录，并生成训练历史曲线图。

### 2. 命令行识别

使用命令行方式识别图像中的数字：

```bash
python infer.py --image path/to/image.png --model lenet5
```

参数说明：
- `--image`: 要识别的图像路径
- `--model`: 使用的模型，可选值为`lenet5`或`mlp`
- `--model_path`: 模型文件路径（可选，默认使用`models/{model_name}_best.pth`）

### 3. 图形界面识别

启动图形界面应用：

```bash
python gui_app.py
```

图形界面功能：
- 手绘数字区域：使用鼠标在画布上绘制数字
- 模型设置：选择使用LeNet-5或MLP模型
- 识别按钮：识别画布上的数字并显示结果和置信度
- 清除画布：清空绘制内容
- 保存图像：将绘制内容保存为图像文件
- 加载图像：加载已有图像进行识别

## 技术细节

### 模型架构

1. **LeNet-5**：专为手写数字识别设计的经典卷积神经网络
   - 结构：2个卷积层 + 2个池化层 + 3个全连接层
   - 参数数量：约60,000

2. **多层感知器(MLP)**：简单的全连接神经网络
   - 结构：3个隐藏层（512, 256, 128个神经元）+ Dropout层
   - 参数数量：约500,000

### 图像预处理流程

1. 灰度化：将彩色图像转换为灰度图
2. 二值化：将灰度图转换为黑白图像，突出数字轮廓
3. 尺寸调整：缩放为28×28像素（MNIST数据集的标准尺寸）
4. 数字居中：将数字居中放置在图像中央
5. 归一化：将像素值缩放到0-1范围

### 训练参数

- 优化器：Adam
- 学习率：0.001
- 损失函数：交叉熵损失
- 批次大小：64
- 训练轮数：10

## 应用场景

- 手写数字识别
- 表单自动填写
- 银行支票识别
- 邮政编码识别
- 教育应用（如自动评分系统）

## 注意事项

1. 首次运行时，程序会自动下载MNIST数据集，可能需要一些时间
2. 训练模型需要一定的计算资源，建议在有GPU的环境下运行以提高训练速度
3. 图形界面识别时，绘制的数字应尽量清晰、居中，以提高识别准确率
4. 如果模型文件不存在，请先运行训练脚本

## 扩展建议

1. 添加更多的深度学习模型（如ResNet、VGG等）
2. 实现实时视频流中的数字识别
3. 添加数据增强功能，提高模型的泛化能力
4. 开发Web界面，支持在线识别